# TLDP_Project — Project Analysis

## Overview
- Purpose: A Python service that generates PowerPoint deliverables (main PPT and brochure) from Monday.com webhook events, using image downloads and content summarization.
- Framework: FastAPI web API that exposes webhook endpoints and a download endpoint for generated PPT files.

## Quick facts
- Entrypoint: `main.py` — registers FastAPI routes and orchestrates processing via helper modules.
- Primary outputs: PPTX files saved to `files/` (e.g., `{item_id}_output.pptx`, `{item_id}_boutput.pptx`).
- Virtualenv present: `venv/` (use that or recreate a venv).

## Key Files
- [main.py](main.py) — FastAPI app, webhook handlers, orchestration, download endpoint.
- [createpowerpoint.py](createpowerpoint.py) — core PPT generation (`generate_main_ppt`, email/send utilities, processing helpers).
- [brochure.py](brochure.py) — brochure-specific PPT generation (`generate_brochure`).
- [space_images.py](space_images.py) — downloads/handles space images used in slides.
- [image.py](image.py) — image utilities (likely resizing/processing).
- [email_utils.py](email_utils.py) — email sending/tracking helpers.
- [style.py](style.py) — styling constants or templates for slides.
- [summary/](summary/) — contains `webinerbrief.py` and `studentjourney.py` summary processors.
- [templates/](templates/) — (exists in workspace; likely PPT/slide templates).

## Dependencies (from `requirements.txt`)
- fastapi==0.104.1
- uvicorn==0.24.0
- python-pptx==1.0.2
- python-docx==1.1.0
- Pillow==11.3.0
- PyMuPDF==1.26.4
- requests==2.31.0
- python-dotenv (unpinned)
- openai (unpinned)
- google-generativeai (unpinned)
- simplejson (unpinned)

Notes:
- Several packages are not pinned to versions (`python-dotenv`, `openai`, `google-generativeai`, `simplejson`). Consider pinning for repeatable installs.

## Observations & Issues
- Duplicate route decorator: `@app.post("/monday-webhook")` appears twice in `main.py` (the second time for `monday_student_journey`). This will override the earlier handler or cause unexpected behavior; likely a bug.
- Secrets/keys: Project uses `openai` and `google-generativeai` (and probably other APIs). Ensure API keys are stored securely (e.g., `.env` + environment variables) and not committed.
- No top-level `README.md` or `LICENSE` present — add documentation for contributors and deployment.
- Limited input validation and global print statements in `main.py`; consider structured logging and robust error handling.
- No tests detected. Add unit tests for core modules (`createpowerpoint.py`, `brochure.py`, `space_images.py`, summary processors).

## Run / Dev setup
Recommended steps (from project root):

```bash
python -m venv .venv
.venv\Scripts\activate   # Windows
pip install -r requirements.txt
# run the API (development)
uvicorn main:app --reload --port 8000
```

Environment variables to set (examples):
- `BASE_URL` - used in `main.py`.
- API keys for OpenAI / Google Generative AI if used by code.

Download endpoint examples:
- GET `/download-ppt?item_id=123&ppt_type=output`
- GET `/download-ppt?item_id=123&ppt_type=brochure`

## Suggested Improvements
- Fix duplicate route in `main.py` (ensure unique paths or use different HTTP methods).
- Add `README.md` with architecture, run instructions, env var list, and examples.
- Pin all dependencies in `requirements.txt` for reproducible installs.
- Add logging (use `logging` module) instead of prints; include structured logs and error reporting.
- Add unit/integration tests and a CI workflow (GitHub Actions) to run tests and linting.
- Validate webhook payloads and add retries/backoff for network calls (image downloads, external APIs).
- Wrap external API calls (OpenAI / Google) with clear interfaces to allow mocking in tests.
- Add type hints and run a static type checker (mypy) for maintainability.
- Consider storing generated PPTs in a durable storage (S3) if scaling beyond local disk.

## Security Considerations
- Do not store API keys in source. Use environment variables or secret stores.
- Sanitize any content used to generate slides to avoid injection through templates.

## Next recommended actions
1. Fix the duplicate route in `main.py` (move `monday_student_journey` to a separate path).
2. Add `README.md` and document env vars.
3. Pin remaining dependencies and run a full install in a fresh venv.
4. Add basic tests for `createpowerpoint.py` and `brochure.py`.

---
Generated by project scan on 2025-12-17.
